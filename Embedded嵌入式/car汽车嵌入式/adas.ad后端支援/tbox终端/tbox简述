#
# 0.导读
#
建议先看看: ./tbox软硬件分析 增强一下对tbox 的理解, 再阅读下面内容, 会比较容易详细理解tbox 的功能, 系统设计, 开发方向;
tbox 用得比较多的就是:
	无线电技术(通信+定位) + 信息安全技术(监管) + v2x 终端(OTA+遥控功能的实现), 这就是tbox 的三大功能板块!!

	* 无线电技术(通信+定位):
		- 通信技术包含:
			局域网交换机技术;
			因为tbox 本身就充当一个ETH 网关设备, 蓝牙网关设备, 通信网网关技术, 后期甚至可能会变成一个wifi 路由器;
		- GPS 定位技术:
			这个没什么好说的, 但要实现这个功能, 得跟卫星网打交道, 需要比较强的信息安全手段;

	* 信息安全技术(监管):
		自己看下面的第一点, 都写好了;

	* v2x 终端(OTA+遥控功能的实现):
		具体看车厂的v2x 的实现要求, 一般最低也会有: OTA+遥控功能的实现, 略;





#
# 1.tbox 需要实现的信息安全功能简介(tbox信息安全系统的实施)
#
由于汽车是比较重要的工业产品, 会牵涉到人身安全, 因此安全等级比较高;
联网终端设备(Telematics Box,T-Box), 汽车行业的tbox 安全方案实施有:
	* 进行车联网ID 入网安全校验(跟SIM 卡ID 入网安全类似)
	* 进行车联网通信安全保障(跟电信供应商的手机安全通信类似)
	* GPS 定位功能与卫星网通信时的安全保障
	* 实现-非法接入检测(跟USB/ETH 接入检测类似)
	* 实现-网络包监控, 过滤(SomeIP/DDS 头包检索, ETH 网络包检索, 车联网网络包检索, 一般使用:linux内核eBPF,iptables 等技术来实现)
	* 提供-硬件级'信息安全SDK'库(可能是使用国密算法库, 但类似openssl):
			- hash 校验算法库
			- 对称加密算法库(rsa/gpg)
			...

硬件级信息安全支撑:
	* 安全算法的硬件级加速(没有硬件加速会妨碍业务发展)
	* 安全算法的硬件级信息校验(一般是ID 数据存放和类似gpg 的二进制证书校验工作, 比较复杂)





#
# 2.上汽智己智联TBOX拆解分析(拆解你就知道大概有哪些东西了)
#
上汽智己智联TBOX拆解分析
	1、TBOX简介
	2、外壳及端子
	3、TBOX组成
		3.1、SOC芯片的作用及常用型号
		3.2、MCU芯片的作用及常用型号
		3.3、通信模块的功能及常用模块型号
		3.4、GPS模块的功能及常用模块型号
		3.5、交换机芯片的功能及常用芯片型号
		3.6、加密芯片的功能及常用芯片型号
	4、上汽TBOX分析
		4.1、SOC-恩智浦 MIMX8QX6AVLFZAC
		4.2、MCU-瑞萨 R7F7015833
		4.3、5G+V2X模块-移远 AG550
		4.4、加密芯片-芯钛 TTM2000A11
		4.5、交换机芯片-MARVELL 88Q5050
		4.6、存储芯片
		4.7、GNSS模块-UBLOX ZED-F9K-00B

	TBOX组成(第三点的详细分析):
		* 1.SOC芯片的作用及常用型号
			SOC芯片是汽车TBOX中的重要组成部分, 它负责处理车辆信息和实现各种功能; 
			SOC芯片通常由多个核心组成, 每个核心负责不同的任务, 使得TBOX可以同时进行多个任务的处理; 
			常用的SOC芯片型号有恩智浦的IMX6和IMX8; 
			这些芯片具有强大的计算和图像处理能力, 可以支持高清视频的播放和实时图像的分析, 为TBOX提供了强大的计算和处理能力; 

		* 2.MCU芯片的作用及常用型号
			MCU芯片是控制车辆各种传感器和执行器的重要部件, 它负责实时监测车辆的状态, 并根据需要控制各个系统的运行; 
			常用的MCU芯片型号有英飞凌(Infineon)的TC2x和TC3x系列、恩智浦S32K14X和瑞萨R7F7X等; 
			这些芯片具有高性能和低能耗的特点, 可以满足TBOX在车辆控制和监测方面的需求; 

		* 3.通信模块的功能及常用模块型号
			通信模块是TBOX中实现车辆与外界通信的关键组件, 它可以通过无线网络连接到互联网, 实现车辆信息的传输和远程控制; 
			常用的通信模块型号有华为的ME909s、MH5000系列和移远AG35、AG550、AG520等; 
			这些模块支持5G、4G、3G网络, 移远AG520、AG550和华为的MH5000支持V2X, 具有稳定可靠的连接性能, 能够实现高速数据传输和远程控制功能; 

		* 4.GPS模块的功能及常用模块型号
			GPS模块是TBOX中用于定位和导航的关键部件, 它能够接收卫星信号, 并通过定位算法计算出车辆的准确位置; 
			常用的GPS模块型号有: 
				和芯星通UM960、UM982
				ublox的ZED-F9K、ZED-F9P、ZED-F9H等; 
			这些模块具有快速定位、高精度和稳定性的特点, 能够满足TBOX在导航和定位方面的需求; 

		* 5.交换机芯片的功能及常用芯片型号
			交换机芯片是TBOX中实现数据交换和通信的重要部件, 它可以实现车辆内各个子系统之间的数据传输和交互; 
			常用的交换机芯片型号有博通(Broadcom)的BCM89x系列和MARVELL 88Q5050等系列; 
			这些芯片具有高带宽和低延迟的特点, 能够实现快速的数据传输和实时的系统交互; 

		* 6.加密芯片的功能及常用芯片型号
			加密芯片是TBOX中保证数据安全和防止恶意攻击的关键组件, 它可以对数据进行加密和解密, 并实现访问控制和身份认证的功能; 
			常用的加密芯片型号有infineonSLE 95250SLS32系列、Maxim DS28E25系列和上海芯钛的TTM2000、TTM3000系列; 
			这些芯片具有高级加密算法和安全性能, 能够保护TBOX中的数据免受非法获取和篡改; 





#
# 3.T-Box系统的主要功能(未敲定, 不同车厂的做法不一样, 这个还不能确定):
#
T-Box系统主要有如下功能:
	(1)CAN通讯, 收发整车CAN网络信号;
	(2)以太网通讯, 用于高带宽通讯需求;
	(3)全网通频段, 支持移动、联通、电信运营商;
	(4)支持SIM贴片卡, 满足物联网需求;
	(5)蓝牙, 用于蓝牙钥匙功能;
	(6)GNSS, 用于GPS和北斗等卫星导航定位;
	(7)内置4G天线, 用于外部天线损坏时备用;
	(8)语音呼叫, E-Call和B-Call, 支持E-Call自动触发;
	(9)收发短信, 用于整车的唤醒;
	(10)网络授时, 用于调整系统时间;
	(11)音频输出, 将E-Call和B-Call的声音发送到IVI系统进行整车播放;
	(12)麦克输入, 支持通话功能;
	(13)备用电池, 用于车辆严重碰撞致KL30断开时的E-Call自动正常触发;
	(14)支持硬件信息安全加密芯片的信息安全方案;
	(15)整车OTA, 用于车端ECU升级包下载, 也可作为OTA升级的主控制器, 执行各ECU的刷写服务;
	(16)远程车控, 通过手机APP对车辆状况进行查询, 以及远程下发空调、车窗等交互指令;
	(17)硬件级信息安全SDK 框架

	tbox 各个功能, 实际也是以android app/驱动, 集成在tbox 系统中, 主要负责: 
			OTA远程升级技术/本地U盘升级
			WIFI/5G/蓝牙-通信模块
			GPS定位/5G对外通信/电信供应商SIM卡/移动流量通信
			收音机
			驾驶行为分析/车况上报/远程查询车辆情况(需要用户安装手机app查看)
			ETC防拆功能/车门入侵告警/车门未锁提醒/车内摄像头监控
			远程访问安全验证/蓝牙车钥匙安全验证(按钮开车门等)



T-Box远程控制(用户安装的车厂android/IOS app):
	T-Box远程控制功能, 是由车辆使用者在智能终端APP上, 下发远程控制车辆的操作指令(如远程闭锁车门);

	该指令会经由用户端的4G网络传输至远程控制功能的云端数据平台(Telematics Service Provider,TSP);
	TSP接收该指令信号后, 对车辆端联网状态进行判断, 继而通过4G网络通道下发相应远程控制指令至车端T-Box;

	车端T-Box接收该指令后, 完成车辆远程控制前置条件判断、整车通信网络唤醒、与车身控制器的防盗鉴权认证后, 下发闭锁车门的CAN报文至CAN总线;

	车端CAN节点网关(Gateway,GW)收到报文后, 将其转发至车身域的车身控制器(Body Control Module,BCM);

	BCM在收到该报文后, 将执行车门闭锁的指令下发给执行器;

	执行器完成对应的动作后, 将门锁状态反馈给BCM, 
	BCM将动作执行结果通过GW反馈给T-Box, 
	T-Box将该状态反馈给TSP, 
	TSP将远程控制执行结果反馈给智能终端APP;

	同时, 车端GW会对远程控制后的车端CAN通信网络进行网络管理, 车辆回归休眠状态;
	至此, 1次远程控制操作完成, 远程控制涉及的车端交互流程, 如图所示: ./TBox远程控制命令的执行流程图.jpg



T-Box远程控制流程多次涉及到车端、智能终端、云端的信息联动, 
将传统的封闭车端功能范畴, 扩展到云端和智能终端, 并高度依赖无线网络环境;
具体涉及到:
	SIM卡资费套餐、
	接入基站网络覆盖、
	核心网调度、
	虚拟专线隧道建设、
	云端服务器负载能力、
	车-管-端3点间通道信息安全网关;



T-Box与整车网络通信:
	T-Box可以将整车重要报文('国标/地标/企标'需求的报文), 以要求的频率和协议形式, 传输到车厂TSP平台, 
	然后车厂TSP平台, 将相关信号流转到国家新能源汽车监控平台、地方新能源汽车监控平台或企业数据仓库, 从而对车辆进行管理或者大数据挖掘;

	同时, T-Box将来自后台的信息推送到整车(如:远程唤醒的命令、远程控制的命令);
	部分车厂将整车OTA和远程诊断的主程序, 集成于T-Box系统中, 然后依赖: T-Box <-> 整车网络 <-> 后台的通信, 实现OTA和远程诊断功能;



T-Box应用开发对信息安全SDK的调用:
	有了信息安全加密芯片和信息安全SDK, 则TBox信息安全开发有了硬件基础和软件基础;
	T-Box供应商进行信息安全应用开发时, 根据信息安全方案商的系统要求结合T-Box具体业务场景, 对信息安全SDK通过接口进行调用, 主要的接口如下:
		(1)获取信息安全SDK版本信息
		(2)判断安全芯片是否存在安全证书
		(3)安全证书申请
		(4)安全通道创建和关闭
		(5)日志打印
		(6)获取安全通道接口状态



